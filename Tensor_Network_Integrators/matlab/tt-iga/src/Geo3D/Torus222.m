function [wn, ctpxn, ctpyn, ctpzn, knot1n, knot2n, knot3n] = Torus222(R, r_int, r_out, nn1, nn2, nn3)
%
r_mid = r_out - r_int;
n1 = 9; n2 = 3; n3 = 3;
p1 = 2; p2 = 2; p3 = 2;

knot1  = [0 0 0 1/4 1/4 2/4 2/4 3/4 3/4 1 1 1];
knot2 = NonUniformKnot(n2, p2);
knot3 = NonUniformKnot(n3, p3);


% 2D surface
% Direction 1 - Collumn index; Direction 2 - Row index
ctpx2D = [-r_int -r_mid -r_out;...
          -r_int -r_mid -r_out;...
          0.0    0.0    0.0;...
          r_int  r_mid r_out;...
          r_int  r_mid r_out;...
          r_int  r_mid r_out;...
          0.0    0.0   0.0;...
          -r_int -r_mid -r_out;...
          -r_int -r_mid -r_out] - R;

ctpy2D = [0.0     0.0    0.0;...
          r_int   r_mid  r_out;...
          r_int   r_mid  r_out;...
          r_int   r_mid  r_out;...
          0.0     0.0    0.0;...
          -r_int -r_mid -r_out;...
          -r_int -r_mid -r_out;...
          -r_int -r_mid -r_out;...
          0.0     0.0    0.0];

%% Sweep to 3D volume
%
ctpx = zeros(n1, n2, n3);
ctpx(:,:,1) = ctpx2D;
%
ctpy = zeros(n1, n2, n3);
ctpy(:,:,1) = ctpy2D;
%
ctpz = zeros(n1, n2, n3);
ctpz(:,:,1) = zeros(n1, n2);

% Layer 3: rotate layer 1 90 degree
[ctpx(:,:,3), ctpy(:,:,3), ctpz(:,:,3)] = RotateCtp(ctpx(:,:,1), ctpy(:,:,1), ctpz(:,:,1), 90, 'y');

%Layer 2:
%-sames x,y coordinates with layer 1
ctpx(:,:,2) = ctpx(:,:,1);
ctpy(:,:,2) = ctpy(:,:,1);
%-sames z coordinates with layer 3
ctpz(:,:,2) = ctpz(:,:,3);

% control weight
wi = zeros(n1, n2, n3);


wi(:,:,1) = [1.0         1.0         1.0;...
             1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
             1.0         1.0         1.0;...
             1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
             1.0         1.0         1.0;...
             1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
             1.0         1.0         1.0;...
             1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
             1.0         1.0         1.0];

wi(:,:,2) =[1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0]*1.0/sqrt(2);

wi(:,:,3) =[1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0;...
            1.0/sqrt(2) 1.0/sqrt(2) 1.0/sqrt(2);...
            1.0         1.0         1.0];
%% Refinement

[wn, ctpxn, ctpyn, ctpzn, knot1n]  = KnotInsertMW1_3D(wi, ctpx, ctpy, ctpz, knot1, sref([nn1 nn1 nn1, nn1], ReduceKnotUnbound(knot1)));
[wn, ctpxn, ctpyn, ctpzn, knot2n]  = KnotInsertMW2_3D(wn, ctpxn, ctpyn, ctpzn, knot2, sref(nn2, ReduceKnotUnbound(knot2)));
[wn, ctpxn, ctpyn, ctpzn, knot3n]  = KnotInsertMW3_3D(wn, ctpxn, ctpyn, ctpzn, knot3, sref(nn3, ReduceKnotUnbound(knot3)));

end